<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Budget Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f4f9;
    }
    h1 { text-align: center; }
    .container { max-width: 800px; margin: auto; }
    form { display: flex; gap: 10px; margin-bottom: 20px; }
    input, select, button { padding: 10px; font-size: 1rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: center; }
    .chart-container { margin-top: 40px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Budget Tracker</h1>
    <form id="expenseForm">
      <input type="number" id="amount" placeholder="Amount" required>
      <select id="category">
        <option>Food</option>
        <option>Transport</option>
        <option>Shopping</option>
        <option>Other</option>
      </select>
      <input type="date" id="date" required>
      <button type="submit">Add</button>
    </form>
    
    <table>
      <thead>
        <tr>
          <th>Amount</th>
          <th>Category</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="expenseTable"></tbody>
    </table>

    <div class="chart-container">
      <canvas id="pieChart"></canvas>
    </div>
  </div>

  <!-- âœ… fixed src -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    let expenses = JSON.parse(localStorage.getItem("expenses")) || [];

    function renderTable() {
      let table = document.getElementById("expenseTable");
      table.innerHTML = "";

      expenses.forEach((exp, i) => {
        table.innerHTML += `
          <tr>
            <td>${exp.amount}</td>
            <td>${exp.category}</td>
            <td>${exp.date}</td>
            <td><button onclick="deleteExpense(${i})">Delete</button></td>
          </tr>
        `;
      });

      localStorage.setItem("expenses", JSON.stringify(expenses));
      renderChart();
    }

    document.getElementById("expenseForm")
      .addEventListener("submit", e => {
        e.preventDefault();

        let amount = document.getElementById("amount").value;
        let category = document.getElementById("category").value;
        let date = document.getElementById("date").value;

        expenses.push({ amount, category, date });

        e.target.reset();
        renderTable();
      });

    function deleteExpense(index) {
      expenses.splice(index, 1);
      renderTable();
    }

    function renderChart() {
      let ctx = document.getElementById("pieChart").getContext("2d");

      let categories = {};
      expenses.forEach(e => {
        categories[e.category] =
          (categories[e.category] || 0) + Number(e.amount);
      });

      new Chart(ctx, {
        type: "pie",
        data: {
          labels: Object.keys(categories),
          datasets: [{
            data: Object.values(categories),
            backgroundColor: ["#007BFF", "#28A745", "#FFC107", "#DC3545"]
          }]
        }
      });
    }

    renderTable();
  </script>
</body>
</html>
